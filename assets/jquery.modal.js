(function(){var d,c,a,b=function(e,f){return function(){return e.apply(f,arguments)}};d=jQuery;c=(function(){function e(){}e.transitions={webkitTransition:"webkitTransitionEnd",mozTransition:"mozTransitionEnd",oTransition:"oTransitionEnd",transition:"transitionend"};e.transition=function(g){var i,f,h,j;i=g[0];j=this.transitions;for(h in j){f=j[h];if(i.style[h]!=null){return f}}};e.execute=function(f,h){var g;g=this.transition(f);if(g!=null){return f.one(g,h)}else{return h()}};e.hide=function(g,f){if(f==null){f="fade"}return g.addClass(f)};e.show=function(g,f){if(f==null){f="fade"}return g.removeClass(f)};e.enable=function(g,f){return g.addClass(f)};e.disable=function(g,f){return g.removeClass(f)};return e})();a=(function(){e.modal=function(g,f){var h;if(f==null){f={}}h=g.data("modal");if(!h){h=new e(g,f);g.data("modal",h)}return h};e.prototype.$=function(f){return this.$modal.find(f)};function e(f,g){if(g==null){g={}}this.show=b(this.show,this);this.hide=b(this.hide,this);this.observe=b(this.observe,this);this.keyup=b(this.keyup,this);this.close=b(this.close,this);this.remove=b(this.remove,this);this.$=b(this.$,this);this.$modal=f;this.settings=g;this.$vignette=d("<div class='vignette fade'></div>")}e.prototype.remove=function(){this.$modal.remove();return this.$vignette.remove()};e.prototype.close=function(f){if(f!=null){f.preventDefault()}if(f!=null){f.stopPropagation()}return this.hide()};e.prototype.keyup=function(f){if(f.target.form!=null){return}if(f.which===27){return this.close()}};e.prototype.observe=function(h){var g,f;if(h==null){h="on"}if(!this.settings["static"]){f=this;g=function(i){if(i.target===this){return f.close(i)}};this.$modal.parent(".modaler")[h]("click",g);d(document)[h]("keyup",this.keyup);this.$vignette[h]("click",this.close);return this.$modal[h]("click",'[data-dismiss="modal"]',this.close)}};e.prototype.hide=function(){var f,h,g=this;f=function(){return g.observe("off")};h=function(){c.disable(d(document.body),"modaled");if(g.$modal.parent(".modaler").length){g.$modal.unwrap()}g.$modal.trigger("hidden");g.$vignette.remove();return g.$modal.hide()};f();this.vignette("hide");return this.modal("hide",h)};e.prototype.show=function(){var f,h,g=this;h=function(){return g.observe("on")};f=function(){c.enable(d(document.body),"modaled");if(!g.$modal.parent(".modaler").length){g.$modal.wrap("<div class='modaler'></div>")}g.$modal.trigger("shown");d(document.body).append(g.$vignette);return g.$modal.show()};f();this.vignette("show");return this.modal("show",h)};e.prototype.modal=function(g,f){this.$vignette.position();c[g](this.$modal);if(f!=null){return c.execute(this.$modal,f)}};e.prototype.vignette=function(g,f){this.$vignette.position();c[g](this.$vignette);if(f!=null){return c.execute(this.$vignette,f)}};return e})();d.fn.extend({modal:function(e){if(e==null){e={}}return this.each(function(){var h,g,f;h=d(this);f=d.extend({},d.fn.modal.defaults,typeof e==="object"&&e);g=typeof e==="string"?e:e.action;if(g==null){g="show"}return a.modal(h,f)[g]()})}})}).call(this);